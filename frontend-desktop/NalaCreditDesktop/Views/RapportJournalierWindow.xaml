<Window x:Class="NalaCreditDesktop.Views.RapportJournalierWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Rapport Journalier - Nala Kredi" 
        Height="800" 
        Width="1100"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    
    <Grid Background="#F8F9FA">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- En-tÃªte -->
        <Border Grid.Row="0" Background="#059669" Padding="25,20">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸ“Š" FontSize="28" Foreground="White" Margin="0,0,20,0"/>
                <StackPanel>
                    <TextBlock Text="Rapport Journalier" 
                               FontSize="22" 
                               FontWeight="Bold" 
                               Foreground="White"/>
                    <TextBlock Text="SynthÃ¨se complÃ¨te des activitÃ©s avec gÃ©nÃ©ration PDF et signature Ã©lectronique" 
                               FontSize="14" 
                               Foreground="#A7F3D0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Contenu principal -->
        <Grid Grid.Row="1" Margin="25">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="400"/>
            </Grid.ColumnDefinitions>

            <!-- Section principale du rapport -->
            <Border Grid.Column="0" 
                    Background="White" 
                    CornerRadius="12" 
                    Padding="25">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="3" Color="#40000000"/>
                </Border.Effect>
                
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- En-tÃªte du rapport -->
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="ðŸ“ˆ RAPPORT JOURNALIER" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="#1F2937"/>
                                <TextBlock x:Name="DateRapportText" 
                                           Text="Date: Mercredi 09 Octobre 2025" 
                                           FontSize="14" 
                                           Foreground="#6B7280" 
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                                <TextBlock x:Name="HeureGenerationText" 
                                           Text="GÃ©nÃ©rÃ© Ã : 18:45:32" 
                                           FontSize="12" 
                                           Foreground="#6B7280"/>
                                <TextBlock x:Name="CaissierRapportText" 
                                           Text="Par: Marie Dupont" 
                                           FontSize="12" 
                                           Foreground="#6B7280"/>
                            </StackPanel>
                        </Grid>

                        <!-- RÃ©sumÃ© des opÃ©rations -->
                        <Border Background="#F0FDF4" 
                                BorderBrush="#22C55E" 
                                BorderThickness="1" 
                                CornerRadius="8" 
                                Padding="20" 
                                Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="ðŸ“‹ RÃ‰SUMÃ‰ DES OPÃ‰RATIONS" 
                                           FontSize="16" 
                                           FontWeight="Bold" 
                                           Foreground="#059669" 
                                           Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- DÃ©pÃ´ts -->
                                    <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ’µ" FontSize="20" HorizontalAlignment="Center"/>
                                        <TextBlock Text="DÃ‰PÃ”TS" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                        <TextBlock x:Name="NombreDepotsText" Text="23" FontSize="18" FontWeight="Bold" Foreground="#059669" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                    
                                    <!-- Retraits -->
                                    <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ’¸" FontSize="20" HorizontalAlignment="Center"/>
                                        <TextBlock Text="RETRAITS" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                        <TextBlock x:Name="NombreRetraitsText" Text="18" FontSize="18" FontWeight="Bold" Foreground="#DC2626" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                    
                                    <!-- Changes -->
                                    <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ”„" FontSize="20" HorizontalAlignment="Center"/>
                                        <TextBlock Text="CHANGES" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                        <TextBlock x:Name="NombreChangesText" Text="6" FontSize="18" FontWeight="Bold" Foreground="#3B82F6" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                    
                                    <!-- Consultations -->
                                    <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ”" FontSize="20" HorizontalAlignment="Center"/>
                                        <TextBlock Text="CONSULTATIONS" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                        <TextBlock x:Name="NombreConsultationsText" Text="12" FontSize="18" FontWeight="Bold" Foreground="#8B5CF6" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Montants par devise -->
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- HTG -->
                            <Border Grid.Column="0" 
                                    Background="#FEF3C7" 
                                    BorderBrush="#F59E0B" 
                                    BorderThickness="1" 
                                    CornerRadius="8" 
                                    Padding="20">
                                <StackPanel>
                                    <TextBlock Text="ðŸ’° MOUVEMENTS HTG" 
                                               FontWeight="SemiBold" 
                                               FontSize="14" 
                                               Foreground="#D97706" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,0,0,15"/>
                                    
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Row="0" Text="DÃ©pÃ´ts:" FontSize="12"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="TotalDepotsHTGText" Text="1,250,000" FontSize="12" FontWeight="SemiBold" Foreground="#059669"/>
                                        
                                        <TextBlock Grid.Row="1" Text="Retraits:" FontSize="12"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="TotalRetraitsHTGText" Text="560,000" FontSize="12" FontWeight="SemiBold" Foreground="#DC2626"/>
                                        
                                        <TextBlock Grid.Row="2" Text="Changes:" FontSize="12"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="TotalChangeHTGText" Text="+45,000" FontSize="12" FontWeight="SemiBold" Foreground="#3B82F6"/>
                                        
                                        <TextBlock Grid.Row="3" Text="Net:" FontWeight="Bold" FontSize="13"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" x:Name="NetHTGText" Text="+735,000" FontWeight="Bold" FontSize="14" Foreground="#F59E0B"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- USD -->
                            <Border Grid.Column="2" 
                                    Background="#EBF4FF" 
                                    BorderBrush="#3B82F6" 
                                    BorderThickness="1" 
                                    CornerRadius="8" 
                                    Padding="20">
                                <StackPanel>
                                    <TextBlock Text="ðŸ’² MOUVEMENTS USD" 
                                               FontWeight="SemiBold" 
                                               FontSize="14" 
                                               Foreground="#1D4ED8" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,0,0,15"/>
                                    
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Row="0" Text="DÃ©pÃ´ts:" FontSize="12"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="TotalDepotsUSDText" Text="3,200" FontSize="12" FontWeight="SemiBold" Foreground="#059669"/>
                                        
                                        <TextBlock Grid.Row="1" Text="Retraits:" FontSize="12"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="TotalRetraitsUSDText" Text="1,850" FontSize="12" FontWeight="SemiBold" Foreground="#DC2626"/>
                                        
                                        <TextBlock Grid.Row="2" Text="Changes:" FontSize="12"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="TotalChangeUSDText" Text="+320" FontSize="12" FontWeight="SemiBold" Foreground="#3B82F6"/>
                                        
                                        <TextBlock Grid.Row="3" Text="Net:" FontWeight="Bold" FontSize="13"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" x:Name="NetUSDText" Text="+1,670" FontWeight="Bold" FontSize="14" Foreground="#3B82F6"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Grid>

                        <!-- Commissions et frais -->
                        <Border Background="#F3E8FF" 
                                BorderBrush="#8B5CF6" 
                                BorderThickness="1" 
                                CornerRadius="8" 
                                Padding="20" 
                                Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="ðŸ’° COMMISSIONS ET FRAIS" 
                                           FontSize="16" 
                                           FontWeight="Bold" 
                                           Foreground="#7C3AED" 
                                           Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Commission dÃ©pÃ´ts:" FontSize="12"/>
                                        <TextBlock x:Name="CommissionDepotsText" Text="1,150 HTG" FontWeight="SemiBold" Foreground="#7C3AED"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Commission retraits:" FontSize="12"/>
                                        <TextBlock x:Name="CommissionRetraitsText" Text="900 HTG" FontWeight="SemiBold" Foreground="#7C3AED"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="Commission changes:" FontSize="12"/>
                                        <TextBlock x:Name="CommissionChangesText" Text="800 HTG" FontWeight="SemiBold" Foreground="#7C3AED"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="3">
                                        <TextBlock Text="TOTAL:" FontWeight="Bold"/>
                                        <TextBlock x:Name="TotalCommissionsText" Text="2,850 HTG" FontWeight="Bold" FontSize="16" Foreground="#7C3AED"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- DÃ©tail des transactions -->
                        <StackPanel>
                            <TextBlock Text="ðŸ“‹ DÃ‰TAIL DES TRANSACTIONS" 
                                       FontSize="16" 
                                       FontWeight="Bold" 
                                       Foreground="#1F2937" 
                                       Margin="0,0,0,15"/>
                            
                            <DataGrid x:Name="DetailTransactionsGrid"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      GridLinesVisibility="Horizontal"
                                      HeadersVisibility="Column"
                                      CanUserReorderColumns="False"
                                      CanUserResizeColumns="True"
                                      SelectionMode="Extended"
                                      ClipboardCopyMode="IncludeHeader"
                                      Height="200"
                                      FontSize="11">
                                <DataGrid.InputBindings>
                                    <KeyBinding Command="ApplicationCommands.Copy" Key="C" Modifiers="Control"/>
                                    <KeyBinding Command="ApplicationCommands.SelectAll" Key="A" Modifiers="Control"/>
                                </DataGrid.InputBindings>
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Copier" 
                                                  Command="ApplicationCommands.Copy"
                                                  InputGestureText="Ctrl+C"/>
                                        <MenuItem Header="Tout sÃ©lectionner" 
                                                  Command="ApplicationCommands.SelectAll"
                                                  InputGestureText="Ctrl+A"/>
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Heure" 
                                                        Binding="{Binding Date, StringFormat='{}{0:HH:mm}'}" 
                                                        Width="60"/>
                                    <DataGridTextColumn Header="Type" 
                                                        Binding="{Binding Type}" 
                                                        Width="80"/>
                                    <DataGridTextColumn Header="Client/Compte" 
                                                        Binding="{Binding NumeroTransaction}" 
                                                        Width="120"/>
                                    <DataGridTextColumn Header="Montant" 
                                                        Binding="{Binding Montant, StringFormat='{}{0:N2}'}" 
                                                        Width="100"/>
                                    <DataGridTextColumn Header="Devise" 
                                                        Binding="{Binding Devise}" 
                                                        Width="60"/>
                                    <DataGridTextColumn Header="Description" 
                                                        Binding="{Binding Description}" 
                                                        Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Panneau de contrÃ´le -->
            <Border Grid.Column="2" 
                    Background="White" 
                    CornerRadius="12" 
                    Padding="20">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="3" Color="#40000000"/>
                </Border.Effect>
                
                <StackPanel>
                    <TextBlock Text="âš™ï¸ CONTRÃ”LES" 
                               FontSize="16" 
                               FontWeight="Bold" 
                               Foreground="#1F2937" 
                               Margin="0,0,0,20"/>
                    
                    <!-- SÃ©lection de pÃ©riode -->
                    <StackPanel Margin="0,0,0,20">
                        <TextBlock Text="ðŸ“… PÃ©riode du rapport :" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,8"/>
                        <ComboBox x:Name="PeriodeComboBox" 
                                  FontSize="14" 
                                  Padding="10,8" 
                                  SelectionChanged="Periode_SelectionChanged">
                            <ComboBoxItem Content="Aujourd'hui" IsSelected="True"/>
                            <ComboBoxItem Content="Hier"/>
                            <ComboBoxItem Content="Cette semaine"/>
                            <ComboBoxItem Content="Semaine derniÃ¨re"/>
                            <ComboBoxItem Content="Ce mois"/>
                            <ComboBoxItem Content="Mois dernier"/>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- Date personnalisÃ©e -->
                    <StackPanel x:Name="DatePersonnaliseePanel" 
                                Visibility="Collapsed" 
                                Margin="0,0,0,20">
                        <TextBlock Text="Date spÃ©cifique :" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,8"/>
                        <DatePicker x:Name="DateSpecifiquePicker" 
                                    FontSize="14" 
                                    Padding="10,8"/>
                    </StackPanel>
                    
                    <!-- Options d'export -->
                    <StackPanel Margin="0,0,0,20">
                        <TextBlock Text="ðŸ“„ Format d'export :" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,8"/>
                        <ComboBox x:Name="FormatExportComboBox" 
                                  FontSize="14" 
                                  Padding="10,8">
                            <ComboBoxItem Content="PDF (RecommandÃ©)" IsSelected="True"/>
                            <ComboBoxItem Content="Excel (.xlsx)"/>
                            <ComboBoxItem Content="CSV (.csv)"/>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- Inclusions -->
                    <StackPanel Margin="0,0,0,20">
                        <TextBlock Text="ðŸ“‹ Inclure dans le rapport :" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,10"/>
                        
                        <CheckBox x:Name="InclureDetailTransactionsCheckBox" 
                                  Content="DÃ©tail des transactions" 
                                  IsChecked="True" 
                                  Margin="0,5"/>
                        <CheckBox x:Name="InclureCommissionsCheckBox" 
                                  Content="Analyse des commissions" 
                                  IsChecked="True" 
                                  Margin="0,5"/>
                        <CheckBox x:Name="InclureGraphiquesCheckBox" 
                                  Content="Graphiques et tendances" 
                                  IsChecked="True" 
                                  Margin="0,5"/>
                        <CheckBox x:Name="InclureStatistiquesCheckBox" 
                                  Content="Statistiques avancÃ©es" 
                                  IsChecked="False" 
                                  Margin="0,5"/>
                    </StackPanel>
                    
                    <!-- Signature Ã©lectronique -->
                    <Border Background="#F0FDF4" 
                            BorderBrush="#22C55E" 
                            BorderThickness="1" 
                            CornerRadius="8" 
                            Padding="15" 
                            Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="âœï¸ SIGNATURE Ã‰LECTRONIQUE" 
                                       FontSize="12" 
                                       FontWeight="SemiBold" 
                                       Foreground="#059669" 
                                       HorizontalAlignment="Center"/>
                            
                            <CheckBox x:Name="SignatureElectroniqueCheckBox" 
                                      Content="Signer Ã©lectroniquement le rapport" 
                                      IsChecked="True" 
                                      FontSize="11" 
                                      Margin="0,10,0,0"
                                      Checked="SignatureElectronique_Checked"
                                      Unchecked="SignatureElectronique_Unchecked"/>
                            
                            <TextBlock x:Name="SignatureInfoText" 
                                       Text="Le rapport sera signÃ© numÃ©riquement avec votre identifiant caissier" 
                                       FontSize="10" 
                                       Foreground="#059669" 
                                       TextWrapping="Wrap" 
                                       Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Boutons d'action -->
                    <StackPanel>
                        <Button x:Name="ActualiserButton" 
                                Content="ðŸ”„ Actualiser DonnÃ©es" 
                                Padding="12,10" 
                                Margin="0,0,0,10"
                                Background="#3B82F6"
                                Foreground="White"
                                BorderThickness="0"
                                FontWeight="SemiBold"
                                Click="Actualiser_Click"/>
                        
                        <Button x:Name="PrevisualiserButton" 
                                Content="ðŸ‘ï¸ PrÃ©visualiser" 
                                Padding="12,10" 
                                Margin="0,0,0,10"
                                Background="#8B5CF6"
                                Foreground="White"
                                BorderThickness="0"
                                FontWeight="SemiBold"
                                Click="Previsualiser_Click"/>
                        
                        <Button x:Name="GenererRapportButton" 
                                Content="ðŸ“Š GÃ©nÃ©rer Rapport" 
                                Padding="12,10" 
                                Background="#059669"
                                Foreground="White"
                                BorderThickness="0"
                                FontWeight="SemiBold"
                                FontSize="14"
                                Click="GenererRapport_Click"/>
                    </StackPanel>
                    
                    <!-- Statut -->
                    <Border x:Name="StatutPanel" 
                            Background="#FEF3C7" 
                            BorderBrush="#F59E0B" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Padding="10" 
                            Margin="0,20,0,0"
                            Visibility="Collapsed">
                        <StackPanel>
                            <TextBlock x:Name="StatutText" 
                                       Text="GÃ©nÃ©ration en cours..." 
                                       FontSize="12" 
                                       FontWeight="SemiBold" 
                                       HorizontalAlignment="Center"/>
                            <ProgressBar x:Name="ProgressBar" 
                                         Height="8" 
                                         Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Barre de statut -->
        <Border Grid.Row="2" 
                Background="#34495E" 
                Padding="20,15">
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" 
                           x:Name="StatutGlobalText"
                           Text="PrÃªt Ã  gÃ©nÃ©rer le rapport journalier" 
                           Foreground="White" 
                           FontSize="14"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="DerniÃ¨re gÃ©nÃ©ration: " 
                               Foreground="#BDC3C7" 
                               FontSize="14"/>
                    <TextBlock x:Name="DerniereGenerationText" 
                               Text="--:--" 
                               Foreground="White" 
                               FontSize="14" 
                               FontWeight="SemiBold"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>