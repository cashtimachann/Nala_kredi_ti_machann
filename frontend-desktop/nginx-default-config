server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/html;
    index index.html index.htm index.nginx-debian.html;
    server_name _;

    location / {
        try_files $uri $uri/ =404;
    }

    # Configuration pour downloads desktop app
    location /downloads {
        alias /var/www/downloads;
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
        
        client_max_body_size 200M;
        
        location ~* \.json$ {
            add_header Access-Control-Allow-Origin * always;
            add_header Access-Control-Allow-Methods "GET, OPTIONS" always;
            add_header Access-Control-Allow-Headers "Content-Type" always;
            add_header Content-Type "application/json; charset=utf-8";
        }
        
        location ~* \.(exe|msi|zip)$ {
            add_header Content-Disposition "attachment";
            add_header X-Content-Type-Options "nosniff";
        }
    }
}
